<html>
  <head>
    <style>
       /* Set the size of the div element that contains the map */
      #map {
        height: 780px;  /* The height is 400 pixels */
        width: 100%;  /* The width is the width of the web page */
       }
    </style>
    
  </head>
  
  
   <body>
     
     <div id="map"></div>
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    
    <script type="text/javascript">
    
    
    //"https://sheets.googleapis.com/v4/spreadsheets/1RuKECX0GcDRv579SrDXkP5K4KKvCmpjbN5Lk8bhJpLg/values/Queried_FrameData!A2:Q?key=AIzaSyA5XfiVmkSNov-TcCOR9Tt7dx6JOdlG2mQ"
    
    //Central London
    //London
    //51.508009, -0.127412
    
    var map;
    var london = {lat: 51.508009, lng: -0.127412};
    var locations = [];  
      
      
      //NEW
      
      function initialiseMap() {
      
          //document.getElementById("logger").innerHTML = "initialiseMap";

          $.getJSON("https://sheets.googleapis.com/v4/spreadsheets/1KVIz5PBPE9vd2k3RajHCP3w_J7dvGQwHuTqx412RhGI/values/Queried_FrameData!A2:Q?key=AIzaSyA5XfiVmkSNov-TcCOR9Tt7dx6JOdlG2mQ", 
          
          function(data) {
                // data.values contains the array of rows from the spreadsheet. Each row is also an array of cell values.
                // Modify the code below to suit the structure of your spreadsheet.
               
               //document.getElementById("logger").innerHTML = "getdata";
               
               $(data.values).each(function() {
                    var location = {};
                    
                    location.frame_id = this[0];
                    location.media_owner = this[1];
                    location.tv_area = this[2];
                    location.frame_type = this[3];
                    location.illumination = this[4];
                    location.faces = this[5];
                    location.longitude = parseFloat(this[6]);
                    location.latitude = parseFloat(this[7]);
                    location.coordinate_type = this[8];
                    location.region = this[9];
                    location.tv_area = this[10];
                    location.town = this[11];
                    location.conurbation = this[12];
                    location.postal_sector = this[13];
                    location.address = this[14];
                    location.sales_code = this[15];
                    location.surface_area = this[16];
                    location.width = this[17];
                    location.height = this[18];
                    location.vehicle_creative = this[19];
                    location.depot_id = this[20];
                    
                    location.url = this[21];
                    
                    locations.push(location);
               });    
               
                   
              map = new google.maps.Map(document.getElementById('map'), {
                zoom: 8,
                center: new google.maps.LatLng(51.508009, -0.127412),
                mapTypeId: 'terrain'
              });  
              
              //Simple Location Markers
              /*
              for (var i = 0; i < locations.length; i++) {
              var marker = new google.maps.Marker({position: {lat: locations[i].latitude, lng: locations[i].longitude}, map: map});
              }*/ 
              
              setLocations(map, locations); //https://github.com/softwaresaved/maps-from-google-spreadsheets/blob/master/map.js
               
               
                
          });
        }
        
        
        function setLocations(map, locations) {
          var bounds = new google.maps.LatLngBounds();
          // Create nice, customised pop-up boxes, to appear when the marker is clicked on
          var infowindow = new google.maps.InfoWindow({
            content: "Content String"
          });
          for (var i = 0; i < locations.length; i++) {
            var new_marker = createMarker(map, locations[i], infowindow);
            bounds.extend(new_marker.position);
          }
          map.fitBounds(bounds);
        }
        
        function createMarker(map, location, infowindow) {
        
          // Modify the code below to suit the structure of your spreadsheet (stored in variable 'location')
          var position = {
            lat: parseFloat(location.latitude),
            lng: parseFloat(location.longitude)
          };
          
          var IconColour;
          var mo_desc;
          var mo = location.media_owner;
          
         switch(mo) {
            case "1":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|0000FF";
              mo_desc = "Adrenalin Advertising";
              break;
            case "2":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|8A2BE2";
              mo_desc = "Clear Channel Outdoor";
              break;
            case "66":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|A52A2A";
              mo_desc = "Elonex Outdoor Media";
              break;
            case "67":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|DEB887";
              mo_desc = "Digital Convenience";
              break;
            case "4":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|5F9EA0";
              mo_desc = "JCDecaux";
              break;
            case "68":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|7FFF00";
              mo_desc = "Hi! Street Digital";
              break;
            case "6":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|D2691E";
              mo_desc = "Ocean Outdoor";
              break;
            case "7":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|FFFAF0";
              mo_desc = "Primesight";
              break;
            case "71":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|6495ED";
              mo_desc = "Boomerang Media";
              break;
            case "8":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|FFF8DC";
              mo_desc = "Signature Outdoor";
              break;
            case "12":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|DC143C";
              mo_desc = "Exterion Media";
              break;
            case "27":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|00FFFF";
              mo_desc = "Outdoor Plus";
              break;
            case "32":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|00008B";
              mo_desc = "EYE";
              break;
            case "33":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|008B8B";
              mo_desc = "Limited Space";
              break;
            case "34":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|B8860B";
              mo_desc = "KBH Transport Media";
              break;
            case "35":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|006400";
              mo_desc = "AdMedia";
              break;
            case "37":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|BDB76B";
              mo_desc = "T4 MEDIA";
              break;
            case "38":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|8B008B";
              mo_desc = "Build";
              break;
            case "39":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|556B2F";
              mo_desc = "MediaCo Outdoor";
              break;
            case "41":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|FF8C00";
              mo_desc = "Ubiquitous";
              break;
            case "49":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|9932CC";
              mo_desc = "Forrest Outdoor Media";
              break;
             case "52":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|8B0000";
              mo_desc = "Perfect Fit Media";
              break;
            case "55":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|E9967A";
              mo_desc = "Taxi Media";
              break;
            case "57":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|8FBC8F";
              mo_desc = "Bay Media";
              break;
            case "58":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|483D8B";
              mo_desc = "InFocus";
              break;
            case "59":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|2F4F4F";
              mo_desc = "Maxx Media";
              break;
            case "60":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|00CED1";
              mo_desc = "8 Outdoor";
              break;
            case "61":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|9400D3";
              mo_desc = "UK Billboards";
              break;
            case "62":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|FF1493";
              mo_desc = "Sherbet London";
              break;
            case "63":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|00BFFF";
              mo_desc = "City Outdoor Media";
              break;
            case "64":
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|B22222";
              mo_desc = "Kong Outdoor";
              break;
            
            default:
              IconColour = "https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|DAA520";
              mo_desc = "TBC";
          }
          
         
         
         var marker = new google.maps.Marker({
            position: position,
            map: map,
            title: location.frame_id,
            //label: mo_desc,
            icon: IconColour
          });
          
          
          google.maps.event.addListener(marker, 'click', function() {
            infowindow.setContent('<div>'+
            '<p><strong>' + ((location.frame_id === undefined) ? location.title : ('<a href="' + location.url +'">' + location.frame_id + '</a>')) + '</strong></p>' +
            ((location.media_owner === undefined) ? "" : ('<p><strong>mo: </strong>' + mo_desc + '</p>')) +
            ((location.sales_code === undefined) ? "" : ('<p><strong>sales_code: </strong>' + location.sales_code + '</p>')) +
            ((location.surface_area === undefined) ? "" : ('<p><strong>surface_area: </strong>' + location.surface_area + '</p>')) +
            '</div>');
            infowindow.open(map, marker);
          });
          return marker;
        
        }
      
      
     
     
    
    </script>
   
   
   <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA5XfiVmkSNov-TcCOR9Tt7dx6JOdlG2mQ&callback=initialiseMap">
    
    </script>
  </body>
  
 
 
</html>
